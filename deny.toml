# ThreatFlux cargo-deny Configuration
# License and security policy for dependencies
# Version: 1.0.0

# https://embarkstudios.github.io/cargo-deny/

[graph]
# Target platforms to check
targets = [
    "x86_64-unknown-linux-gnu",
    "x86_64-unknown-linux-musl",
    "aarch64-unknown-linux-gnu",
    "x86_64-apple-darwin",
    "aarch64-apple-darwin",
    "x86_64-pc-windows-msvc",
]
all-features = true

# =============================================================================
# Licenses
# =============================================================================
[licenses]
# Confidence threshold for license detection
confidence-threshold = 0.8

# Allow specific licenses (using SPDX identifiers)
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "Zlib",
    "CC0-1.0",
    "Unicode-DFS-2016",
    "Unicode-3.0",
    "MPL-2.0",
    "BSL-1.0",
    "0BSD",
]

# Private crates can have any license
private = { ignore = true }

# Clarify licenses for specific crates if needed
[[licenses.clarify]]
name = "ring"
expression = "MIT AND ISC AND OpenSSL"
license-files = [{ path = "LICENSE", hash = 0xbd0eed23 }]

# =============================================================================
# Bans
# =============================================================================
[bans]
# Lint level for multiple versions of the same crate
multiple-versions = "warn"

# Wildcards in version specs
wildcards = "warn"

# Highlight which crate pulled in duplicates
highlight = "all"

# Workspace handling
workspace-default-features = "allow"
external-default-features = "allow"

# =============================================================================
# Advisories
# =============================================================================
[advisories]
# Advisory database
db-path = "~/.cargo/advisory-db"
db-urls = ["https://github.com/rustsec/advisory-db"]

# How to handle yanked crates
yanked = "warn"

# Ignore specific advisories (add with justification)
ignore = [
    # Example: "RUSTSEC-2020-0001", # Reason for ignoring
]

# =============================================================================
# Sources
# =============================================================================
[sources]
# Lint level for unknown registries
unknown-registry = "deny"

# Lint level for unknown git sources
unknown-git = "warn"

# Allowed registries
allow-registry = ["https://github.com/rust-lang/crates.io-index"]

# Allowed git sources (add organization repos as needed)
allow-git = []

[sources.allow-org]
# Allow git sources from specific organizations
github = ["threatflux"]
